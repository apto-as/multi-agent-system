{
  "audit_type": "container_security",
  "timestamp": "2025-11-18T15:30:00+09:00",
  "auditor": "Hestia (Security Guardian)",
  "image": {
    "name": "tmws:v2.4.0-test",
    "size": "808MB",
    "id": "6340fe9eeeeb",
    "digest": "sha256:6340fe9eeeebea5433e93a8adba2324a0625f6fbfd511554e3944e0cd669f14f"
  },
  "trivy_scan": {
    "critical_count": 0,
    "high_count": 1,
    "medium_count": 0,
    "vulnerabilities": [
      {
        "cve": "CVE-2024-23342",
        "severity": "HIGH",
        "package": "ecdsa",
        "installed_version": "0.19.1",
        "fixed_version": null,
        "cvss_score": 7.4,
        "title": "python-ecdsa: vulnerable to the Minerva attack",
        "description": "Timing attack on ECDSA signature validation, potentially leaking private keys",
        "affected_component": "python-jose (JWT library)",
        "exploitability": "HIGH attack complexity, requires sophisticated timing analysis",
        "mitigation": "Monitor ecdsa updates, consider HMAC-only JWT mode (RS256 â†’ HS256)"
      }
    ]
  },
  "secret_exposure": {
    "env_vars_found": ["GPG_KEY (public key, Python official, safe)"],
    "history_secrets_found": [],
    "runtime_secrets": "None",
    "risk_level": "NONE"
  },
  "file_permissions": {
    "world_writable_files": [],
    "suid_files": [],
    "sgid_files": [],
    "license_file_permissions": "N/A - LICENSE files not found in /app"
  },
  "compliance_issues": [
    {
      "severity": "MEDIUM",
      "type": "LICENSE_MISSING",
      "description": "Apache 2.0 LICENSE file not included in Docker image",
      "requirement": "Apache 2.0 requires LICENSE file distribution with binary",
      "impact": "License compliance transparency lacking",
      "remediation": "Add COPY LICENSE /app/ to Dockerfile",
      "blocking": false
    },
    {
      "severity": "LOW",
      "type": "DOCUMENTATION_MISSING",
      "description": "ATHENA_LICENSE_DISTRIBUTION_ANALYSIS.md not in container",
      "requirement": "Phase 2E-1 documentation requirement",
      "impact": "License strategy not documented in production image",
      "remediation": "Add COPY ATHENA_LICENSE_DISTRIBUTION_ANALYSIS.md /app/docs/ (optional)",
      "blocking": false
    }
  ],
  "pass": false,
  "conditional_pass": true,
  "critical_findings": [],
  "high_findings": [
    {
      "id": "CVE-2024-23342",
      "severity": "HIGH",
      "impact": "Conditional approval only - timing attack risk in JWT crypto",
      "recommendation": "Deploy with monitoring, track ecdsa security advisories"
    },
    {
      "id": "LICENSE_MISSING",
      "severity": "MEDIUM",
      "impact": "Apache 2.0 compliance incomplete",
      "recommendation": "Add LICENSE file to Docker image before production deployment"
    }
  ],
  "recommendation": {
    "decision": "CONDITIONAL APPROVAL",
    "conditions": [
      "Add LICENSE file to Docker image (Dockerfile line ~150)",
      "Monitor CVE-2024-23342 for patch availability",
      "Implement rate limiting on JWT endpoints (already done)",
      "Consider HMAC-only JWT mode migration (Phase 2F)"
    ],
    "blocking_issues": 0,
    "non_blocking_issues": 2
  },
  "next_phase": "Block 2: License Distribution Security (30 minutes)"
}
