# =============================================================================
# TMWS v2.3.1 Docker Deployment Configuration - Security-First Template
# =============================================================================
# ⚠️  SECURITY WARNING: Copy this file to .env and set YOUR OWN values
# ⚠️  NEVER commit .env to version control (already in .gitignore)
# ⚠️  This template uses FAIL-SECURE defaults (production mode, strict policies)
# =============================================================================

# -----------------------------------------------------------------------------
# Environment Configuration (CRITICAL: Fail-Secure Default)
# -----------------------------------------------------------------------------
# SECURITY: Defaults to 'production' to prevent accidental exposure
# Change to 'development' ONLY on local machines, NEVER in production
# Production mode enforces:
#   - HTTPS requirements
#   - Strict CORS policies
#   - Rate limiting
#   - Security headers
#   - Audit logging
TMWS_ENVIRONMENT=production

# -----------------------------------------------------------------------------
# Secret Key (CRITICAL: Generate unique 64-character hex string)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY CRITICAL: This key protects JWT tokens and encryption
# ⚠️  Generate with: openssl rand -hex 32
# ⚠️  DO NOT use this example value - it is INVALID by design
# ⚠️  Keep this secret secure - compromise allows full system access
#
# Generation example:
#   $ openssl rand -hex 32
#   a3f8b9c2d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1
#
TMWS_SECRET_KEY=GENERATE_YOUR_OWN_64_CHARACTER_HEX_STRING_WITH_OPENSSL_RAND_HEX_32

# -----------------------------------------------------------------------------
# Database Configuration (SQLite with WAL mode for concurrent reads)
# -----------------------------------------------------------------------------
# SECURITY: SQLite provides adequate security for <1000 concurrent users
# WAL mode enables concurrent reads while maintaining ACID guarantees
# Path /app/data/ is mounted volume (see docker-compose.yml)
#
# Format: sqlite+aiosqlite:///path/to/database.db
# Production: Use absolute path for clarity
TMWS_DATABASE_URL=sqlite+aiosqlite:////app/data/tmws.db

# -----------------------------------------------------------------------------
# Ollama Configuration (Embedding Service)
# -----------------------------------------------------------------------------
# ⚠️  REQUIRED: Ollama must be running with multilingual-e5-large model
# Setup:
#   1. Install Ollama: https://ollama.ai/download
#   2. Pull model: ollama pull zylonai/multilingual-e5-large
#   3. Start server: ollama serve (default port 11434)
#
# Deployment Modes:
#   Mac (native Ollama):     http://host.docker.internal:11434
#   Windows (native):        http://host.docker.internal:11434
#   Linux (native):          http://host.docker.internal:11434
#   Docker Compose Ollama:   http://ollama:11434
#
# SECURITY: Use internal network, never expose Ollama to public internet
TMWS_OLLAMA_BASE_URL=http://host.docker.internal:11434

# -----------------------------------------------------------------------------
# CORS Origins (CRITICAL: Restrict to specific domains)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY CRITICAL: Controls which web applications can call the API
# ⚠️  In production: Replace with YOUR actual domain(s)
# ⚠️  NEVER use "*" wildcard in production
#
# Format: JSON array of allowed origins (must include protocol and port)
# Examples:
#   Development:  ["http://localhost:3000","http://localhost:8080"]
#   Production:   ["https://app.example.com","https://admin.example.com"]
#   Both:         ["https://app.example.com","http://localhost:3000"]
#
# Default: Localhost only (secure for development)
TMWS_CORS_ORIGINS=["http://localhost:3000"]

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# SECURITY: Production should use INFO or WARNING (not DEBUG)
# DEBUG mode may leak sensitive information in logs
#
# Levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Recommendations:
#   Development:  DEBUG (detailed troubleshooting)
#   Staging:      INFO (moderate detail)
#   Production:   WARNING (errors and warnings only)
TMWS_LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Authentication & Authorization (RBAC + JWT + API Keys)
# -----------------------------------------------------------------------------
# SECURITY: Authentication MUST be enabled in production
# Disabling auth exposes ALL data without access control
#
# TMWS_AUTH_ENABLED: Master switch for authentication system
# TMWS_API_KEY_EXPIRE_DAYS: API key rotation policy (90 days recommended)
TMWS_AUTH_ENABLED=true
TMWS_API_KEY_EXPIRE_DAYS=90

# JWT Token Configuration
# TMWS_JWT_ALGORITHM: Cryptographic algorithm (HS256 recommended for shared secret)
# TMWS_JWT_EXPIRE_MINUTES: Token lifetime (15-60 minutes recommended)
# TMWS_JWT_REFRESH_DAYS: Refresh token lifetime (7 days recommended)
TMWS_JWT_ALGORITHM=HS256
TMWS_JWT_EXPIRE_MINUTES=30
TMWS_JWT_REFRESH_DAYS=7

# -----------------------------------------------------------------------------
# Rate Limiting (DDoS Protection)
# -----------------------------------------------------------------------------
# SECURITY: Prevents brute-force attacks and API abuse
# Implements token bucket algorithm with IP-based tracking
#
# TMWS_RATE_LIMIT_ENABLED: Master switch for rate limiting
# TMWS_RATE_LIMIT_PER_MINUTE: Requests allowed per IP per minute
# TMWS_RATE_LIMIT_BURST: Maximum burst size (temporary spike allowance)
#
# Recommendations:
#   Public API:       30-60 requests/minute
#   Internal API:     100-200 requests/minute
#   Development:      1000 requests/minute (disable effectively)
TMWS_RATE_LIMIT_ENABLED=true
TMWS_RATE_LIMIT_PER_MINUTE=60
TMWS_RATE_LIMIT_BURST=10

# -----------------------------------------------------------------------------
# Security Headers (OWASP Recommendations)
# -----------------------------------------------------------------------------
# SECURITY: HTTP security headers protect against common web attacks
# Implements OWASP Secure Headers Project recommendations
#
# Headers configured:
#   - X-Content-Type-Options: nosniff (prevent MIME sniffing)
#   - X-Frame-Options: DENY (prevent clickjacking)
#   - X-XSS-Protection: 1; mode=block (legacy XSS protection)
#   - Strict-Transport-Security: HTTPS enforcement
#   - Content-Security-Policy: Script execution control
#
# MUST be enabled in production
TMWS_SECURITY_HEADERS_ENABLED=true

# -----------------------------------------------------------------------------
# Audit Logging (Compliance & Security Monitoring)
# -----------------------------------------------------------------------------
# SECURITY: Records all security-relevant events for compliance/forensics
# Required for:
#   - SOC 2 compliance
#   - GDPR compliance (access logging)
#   - Incident response
#   - Threat detection
#
# Logged events:
#   - Authentication attempts (success/failure)
#   - Authorization decisions (access granted/denied)
#   - Data access (read/write/delete)
#   - Configuration changes
#   - Security policy violations
#
# TMWS_AUDIT_LOG_ENABLED: Master switch for audit logging
# TMWS_AUDIT_LOG_RETENTION_DAYS: Log retention policy (365 days recommended)
TMWS_AUDIT_LOG_ENABLED=true
TMWS_AUDIT_LOG_RETENTION_DAYS=365

# -----------------------------------------------------------------------------
# Namespace Isolation (Multi-Tenant Security)
# -----------------------------------------------------------------------------
# SECURITY: Enforces data isolation between agents/teams
# Critical for multi-tenant deployments
#
# TMWS_NAMESPACE_ISOLATION_ENABLED: Master switch for namespace enforcement
# TMWS_DEFAULT_NAMESPACE: Fallback namespace (should not be used in practice)
#
# Security model:
#   - PRIVATE: Owner only
#   - TEAM: Same namespace
#   - SHARED: Explicit agent list
#   - PUBLIC: All agents (read-only)
#   - SYSTEM: All agents (read-only, high privilege)
TMWS_NAMESPACE_ISOLATION_ENABLED=true
TMWS_DEFAULT_NAMESPACE=default

# -----------------------------------------------------------------------------
# License Management (Production Deployment)
# -----------------------------------------------------------------------------
# Optional: Enable license validation for production deployments
# Contact: licensing@tmws.ai for production license keys
#
# TMWS_LICENSE_KEY: Your production license key
# TMWS_LICENSE_REQUIRED: Enforce license validation (false = permissive mode)
#
# Permissive mode (default):
#   - No license required for development/testing
#   - Optional license for production (adds support + features)
#
# Strict mode (production):
#   - License required to start server
#   - Automated compliance checks
#   - Priority support
# TMWS_LICENSE_KEY=
# TMWS_LICENSE_REQUIRED=false

# -----------------------------------------------------------------------------
# Performance & Resource Limits
# -----------------------------------------------------------------------------
# Connection pool limits (SQLite doesn't use connection pooling like PostgreSQL)
# These settings control SQLAlchemy's async engine behavior
TMWS_DB_POOL_SIZE=5
TMWS_DB_MAX_OVERFLOW=10

# Vector search configuration
# TMWS_VECTOR_SEARCH_TOP_K: Default number of results for semantic search
# TMWS_VECTOR_SEARCH_MIN_SIMILARITY: Minimum cosine similarity (0.0-1.0)
TMWS_VECTOR_SEARCH_TOP_K=10
TMWS_VECTOR_SEARCH_MIN_SIMILARITY=0.7

# ChromaDB configuration
# TMWS_CHROMA_COLLECTION_NAME: Vector collection name
# TMWS_CHROMA_DISTANCE_METRIC: Similarity metric (cosine recommended)
TMWS_CHROMA_COLLECTION_NAME=tmws_memories
TMWS_CHROMA_DISTANCE_METRIC=cosine

# -----------------------------------------------------------------------------
# Development & Debugging (DISABLE IN PRODUCTION)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY WARNING: These settings expose sensitive information
# ⚠️  NEVER enable in production
#
# TMWS_DEBUG_MODE: Enables detailed error messages and stack traces
# TMWS_RELOAD: Auto-reload on code changes (development only)
# TMWS_PROFILING: Performance profiling (high overhead)
#
# All should be false/disabled in production
# TMWS_DEBUG_MODE=false
# TMWS_RELOAD=false
# TMWS_PROFILING=false

# -----------------------------------------------------------------------------
# API Server Configuration
# -----------------------------------------------------------------------------
# TMWS_HOST: Bind address (0.0.0.0 for Docker, 127.0.0.1 for local)
# TMWS_PORT: API server port (default 8000)
# TMWS_WORKERS: Number of worker processes (1 for development, CPU count for production)
TMWS_HOST=0.0.0.0
TMWS_PORT=8000
TMWS_WORKERS=1

# =============================================================================
# End of Configuration
# =============================================================================
# Quick Start:
#   1. Copy this file: cp .env.example .env
#   2. Generate secret key: openssl rand -hex 32
#   3. Update TMWS_SECRET_KEY in .env
#   4. Update TMWS_CORS_ORIGINS for your domain
#   5. Review all SECURITY settings
#   6. Start services: docker-compose up -d
#
# Security Checklist:
#   ☑ Unique SECRET_KEY generated
#   ☑ CORS_ORIGINS restricted to your domains
#   ☑ LOG_LEVEL set to INFO or WARNING
#   ☑ AUTH_ENABLED=true
#   ☑ RATE_LIMIT_ENABLED=true
#   ☑ SECURITY_HEADERS_ENABLED=true
#   ☑ AUDIT_LOG_ENABLED=true
#   ☑ NAMESPACE_ISOLATION_ENABLED=true
#   ☑ DEBUG_MODE disabled (not present in .env)
#
# Support: https://github.com/apto-as/tmws/issues
# Documentation: https://github.com/apto-as/tmws/docs
# =============================================================================
